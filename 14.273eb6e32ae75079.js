"use strict";(self.webpackChunkfact_front=self.webpackChunkfact_front||[]).push([[14],{4014:(C,g,i)=>{i.r(g),i.d(g,{InvoicesModule:()=>B});var r=i(6733),e=i(755),d=i(4288),p=i(2295),m=i(932),T=i(8513),u=i(4039),h=i(1749),l=i(319),v=i(4447),y=i(2997),_=i(4950),I=i(3472),E=i(3690);let b=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[r.ez]}),n})(),S=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[r.ez]}),n})();var P=i(9082),x=i(6752),M=i(5893),A=i(5275);let J=(()=>{class n{constructor(){this.translateService=(0,e.f3M)(u.sK)}transform(t){return t?this.translateService.instant(A.cM.find(o=>o.value===t)?.text):null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=e.Yjl({name:"parseDocumentType",type:n,pure:!0}),n})(),U=(()=>{class n{constructor(){this.translateService=(0,e.f3M)(u.sK)}transform(t){return t?this.translateService.instant(A.pc.find(o=>o.value===t)?.text):null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=e.Yjl({name:"parseDocumentStatus",type:n,pure:!0}),n})();function D(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.createInvoice())}),e._UZ(1,"fa-icon",1),e._uU(2),e.ALo(3,"titlecase"),e.ALo(4,"translate"),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("icon",t.faPlus),e.xp6(1),e.hij(" ",e.lcZ(3,2,e.lcZ(4,4,"a\xf1adir"))," ")}}function F(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.viewInvoice(c.selectedInvoices()[0]))}),e._UZ(1,"fa-icon",1),e._uU(2),e.ALo(3,"titlecase"),e.ALo(4,"translate"),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("icon",t.faEye),e.xp6(1),e.hij(" ",e.lcZ(3,2,e.lcZ(4,4,"ver"))," ")}}function L(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.updateInvoice(c.selectedInvoices()[0]))}),e._UZ(1,"fa-icon",1),e._uU(2),e.ALo(3,"titlecase"),e.ALo(4,"translate"),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("icon",t.faPencil),e.xp6(1),e.hij(" ",e.lcZ(3,2,e.lcZ(4,4,"editar"))," ")}}function O(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.removeInvoices())}),e._UZ(1,"fa-icon",1),e._uU(2),e.ALo(3,"titlecase"),e.ALo(4,"translate"),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("icon",t.faTrashCan),e.xp6(1),e.hij(" ",e.lcZ(3,2,e.lcZ(4,4,"eliminar"))," ")}}function R(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"fa-icon",14),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().$implicit,a=e.oxw();return e.KtG(a.viewInvoice(c))}),e.ALo(1,"translate"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("icon",t.faEye)("ngbTooltip",e.lcZ(1,2,"Ver factura"))}}function Q(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"fa-icon",14),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().$implicit,a=e.oxw();return e.KtG(a.updateInvoice(c))}),e.ALo(1,"translate"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("icon",t.faPencil)("ngbTooltip",e.lcZ(1,2,"Editar factura"))}}function z(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"fa-icon",14),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().$implicit,a=e.oxw();return e.KtG(a.removeInvoices(null==c?null:c.uuid))}),e.ALo(1,"translate"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("icon",t.faTrashCan)("ngbTooltip",e.lcZ(1,2,"Eliminar factura"))}}function N(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"input",11),e.NdJ("click",function(){const a=e.CHM(t).$implicit,f=e.oxw();return e.KtG(f.selectElement(a))}),e.qZA()(),e.TgZ(3,"td")(4,"span"),e._uU(5),e.qZA()(),e.TgZ(6,"td")(7,"span"),e._uU(8),e.qZA()(),e.TgZ(9,"td")(10,"span"),e._uU(11),e.ALo(12,"parseDocumentType"),e.qZA()(),e.TgZ(13,"td")(14,"span"),e._uU(15),e.ALo(16,"parseDocumentStatus"),e.qZA()(),e.TgZ(17,"td")(18,"div",12),e.YNc(19,R,2,4,"fa-icon",13),e.YNc(20,Q,2,4,"fa-icon",13),e.YNc(21,z,2,4,"fa-icon",13),e.qZA()()()}if(2&n){const t=s.$implicit,o=e.oxw();e.xp6(2),e.Q6J("checked",o.isChecked(t)),e.xp6(3),e.Oqu(null==t||null==t.issuer?null:t.issuer.name),e.xp6(3),e.Oqu(null==t||null==t.receiver?null:t.receiver.name),e.xp6(3),e.Oqu(e.lcZ(12,8,null==t?null:t.type)),e.xp6(4),e.Oqu(e.lcZ(16,10,null==t?null:t.status)),e.xp6(4),e.Q6J("ngIf",o.canView),e.xp6(1),e.Q6J("ngIf",o.canEdit),e.xp6(1),e.Q6J("ngIf",o.canRemove)}}function K(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",15)(1,"ngb-pagination",16),e.NdJ("pageChange",function(c){e.CHM(t);const a=e.oxw();return e.KtG(a.changePagination(c))}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("collectionSize",null==t.query?null:t.query.total)("pageSize",null==t.query?null:t.query.limit)("page",null==t.query?null:t.query.page)("maxSize",5)}}let Z=(()=>{class n extends E.u{constructor(t,o,c,a,f){super(),this._invoicesService=t,this._toastService=o,this._modal=c,this._router=a,this._zone=f,this.invoices=(0,e.tdS)([]),this.selectedInvoices=(0,e.tdS)([]),this.filters=(0,e.tdS)(null),this.faPlus=d.r8p,this.faTrashCan=d.Vui,this.faPencil=d.TzT,this.faEye=d.Mdf,this.faFileExcel=d.icc,this.query={limit:10,offset:0},this.canAdd=!0,this.canEdit=!0,this.canRemove=!0,this.canView=!0}getInvoices(){this._invoicesService.getElements(this.query,this.filters()).pipe((0,h.R)(this.observableDestroy$)).subscribe({next:t=>{this.invoices.set(t?.results)}})}selectElement(t){const o=this.selectedInvoices().findIndex(c=>c?.uuid===t.uuid);this.selectedInvoices.mutate(o>-1?c=>{c.splice(o,1)}:c=>{c.push(t)})}isChecked(t){return this.selectedInvoices().some(o=>o?.uuid===t?.uuid)}viewInvoice(t){}updateInvoice(t){this._zone.run(()=>{this._router.navigate(["back-office/invoices/edit/"+t.uuid]).then()})}createInvoice(){this._zone.run(()=>{this._router.navigate(["back-office/invoices/create"]).then()})}removeInvoices(t){const o=this._modal.open(P.c,{size:"sm"});o.componentInstance.question=t?"\xbfEst\xe1 seguro que desea eliminar este elemento?":"\xbfEst\xe1 seguro que desea eliminar todos los elementos?",o.result.then(c=>{"accept"===c&&(t?this._invoicesService.remove(t).pipe((0,h.R)(this.observableDestroy$)).subscribe({next:()=>{this.getInvoices()}}):(0,l.D)(this.selectedInvoices()?.map(a=>this._invoicesService.remove(a?.uuid))).pipe((0,h.R)(this.observableDestroy$)).subscribe({next:()=>{this._toastService.showToast((0,m.J)("Factura eliminada exitosamente"),I.p.SUCCESS),this.getInvoices()},error:()=>{this._toastService.showToast((0,m.J)("Ha ocurrido un error al eliminar las facturas"),I.p.DANGER)}}))})}changePagination(t){this.query.page=t,this.query.offset=10*(t-1),this.getInvoices()}search(t){this.filters.set(t),this.getInvoices()}ngOnInit(){this.getInvoices()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(_.q),e.Y36(I.k),e.Y36(p.FF),e.Y36(x.F0),e.Y36(e.R0b))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-invoices-table"]],inputs:{canAdd:"canAdd",canEdit:"canEdit",canRemove:"canRemove",canView:"canView"},standalone:!0,features:[e._Bn([_.q]),e.qOj,e.jDz],decls:37,vars:33,consts:[[1,"d-flex","flex-column","gap-3","mt-5"],[3,"icon"],[1,"component-title","p-2"],[3,"filters"],[1,"d-flex","justify-content-end","gap-1"],["class","btn btn-secondary",3,"click",4,"ngIf"],[1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],["class","d-flex justify-content-center p-2",4,"ngIf"],[1,"btn","btn-secondary",3,"click"],["type","checkbox",1,"cursor-pointer",3,"checked","click"],[1,"icons-table-container"],["placement","left",3,"icon","ngbTooltip","click",4,"ngIf"],["placement","left",3,"icon","ngbTooltip","click"],[1,"d-flex","justify-content-center","p-2"],[3,"collectionSize","pageSize","page","maxSize","pageChange"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"div"),e._UZ(2,"fa-icon",1),e.TgZ(3,"span",2),e._uU(4),e.ALo(5,"capitalize"),e.ALo(6,"translate"),e.qZA()(),e._UZ(7,"app-filters-chips",3),e.TgZ(8,"div",4),e.YNc(9,D,5,6,"button",5),e.YNc(10,F,5,6,"button",5),e.YNc(11,L,5,6,"button",5),e.YNc(12,O,5,6,"button",5),e.qZA(),e.TgZ(13,"table",6)(14,"thead")(15,"tr"),e._UZ(16,"th",7),e.TgZ(17,"th",7),e._uU(18),e.ALo(19,"titlecase"),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"th",7),e._uU(22),e.ALo(23,"titlecase"),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"th",7),e._uU(26),e.ALo(27,"titlecase"),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"th",7),e._uU(30),e.ALo(31,"titlecase"),e.ALo(32,"translate"),e.qZA(),e._UZ(33,"th",7),e.qZA()(),e.TgZ(34,"tbody"),e.YNc(35,N,22,12,"tr",8),e.qZA()(),e.YNc(36,K,2,4,"div",9),e.qZA()),2&t){let c,a,f;e.xp6(2),e.Q6J("icon",o.faFileExcel),e.xp6(2),e.Oqu(e.lcZ(5,13,e.lcZ(6,15,"facturas"))),e.xp6(3),e.Q6J("filters",o.filters()),e.xp6(2),e.Q6J("ngIf",o.canAdd),e.xp6(1),e.Q6J("ngIf",1===(null==(c=o.selectedInvoices())?null:c.length)&&o.canView),e.xp6(1),e.Q6J("ngIf",1===(null==(a=o.selectedInvoices())?null:a.length)&&o.canEdit),e.xp6(1),e.Q6J("ngIf",(null==(f=o.selectedInvoices())?null:f.length)>0&&o.canRemove),e.xp6(6),e.Oqu(e.lcZ(19,17,e.lcZ(20,19,"emisor"))),e.xp6(4),e.Oqu(e.lcZ(23,21,e.lcZ(24,23,"cliente"))),e.xp6(4),e.Oqu(e.lcZ(27,25,e.lcZ(28,27,"tipo"))),e.xp6(4),e.Oqu(e.lcZ(31,29,e.lcZ(32,31,"estado"))),e.xp6(5),e.Q6J("ngForOf",o.invoices()),e.xp6(1),e.Q6J("ngIf",null==o.query?null:o.query.total)}},dependencies:[u.aw,u.X$,T.uH,T.BN,v.m,y.P,M.e,r.rS,p.N9,r.O5,r.sg,p._L,b,J,S,U],changeDetection:0}),n})();var Y=i(3072);const j=[{path:"",component:(()=>{class n{constructor(t){this._authenticatedUserService=t,this.canAdd=!1,this.canEdit=!1,this.canView=!1,this.canRemove=!1}search(t){this.invoiceTable.search(t)}ngOnInit(){const t=this._authenticatedUserService.isUserAdmin();this.canAdd=this._authenticatedUserService.checkPermission("app.add_document")&&!t,this.canEdit=this._authenticatedUserService.checkPermission("app.change_document")&&!t,this.canView=this._authenticatedUserService.checkPermission("app.view_document")||t,this.canRemove=this._authenticatedUserService.checkPermission("app.delete_document")&&!t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Y.G))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-invoices"]],viewQuery:function(t,o){if(1&t&&e.Gf(Z,5),2&t){let c;e.iGM(c=e.CRH())&&(o.invoiceTable=c.first)}},decls:1,vars:4,consts:[[3,"canAdd","canEdit","canRemove","canView"]],template:function(t,o){1&t&&e._UZ(0,"app-invoices-table",0),2&t&&e.Q6J("canAdd",o.canAdd)("canEdit",o.canEdit)("canRemove",o.canRemove)("canView",o.canView)},dependencies:[Z],changeDetection:0}),n})()},{path:"create",data:{breadcrumb:"crear"},loadChildren:()=>Promise.all([i.e(777),i.e(687),i.e(853),i.e(535),i.e(628),i.e(592),i.e(690)]).then(i.bind(i,7690)).then(n=>n.CreateInvoiceModule)},{path:"edit/:id",data:{breadcrumb:"editar"},loadChildren:()=>Promise.all([i.e(777),i.e(687),i.e(853),i.e(535),i.e(628),i.e(592),i.e(690)]).then(i.bind(i,7690)).then(n=>n.CreateInvoiceModule)}];let G=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[x.Bz.forChild(j),x.Bz]}),n})(),B=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[r.ez,G,Z]}),n})()},4950:(C,g,i)=>{i.d(g,{q:()=>T});var r=i(7560),e=i(7557),d=i(4230),p=i(8982),m=i(755);let T=(()=>{class u extends d.M{constructor(l){super(l),this.url=e.me,this.urlId=e.gu}addLine(l,v){return this.http.post(e.yA.replace(":id",l),v).pipe((0,r.K)(p.F.handleError))}editDocument(l,v){return this.http.patch(e.gu.replace(":id",l),v).pipe((0,r.K)(p.F.handleError))}addCharge(l,v){return this.http.post(e.Yq.replace(":id",l),v).pipe((0,r.K)(p.F.handleError))}emit(l){return this.http.post(e.Mq,l).pipe((0,r.K)(p.F.handleError))}}return u.\u0275fac=function(l){return new(l||u)(m.LFG(m.zs3))},u.\u0275prov=m.Yz7({token:u,factory:u.\u0275fac}),u})()}}]);