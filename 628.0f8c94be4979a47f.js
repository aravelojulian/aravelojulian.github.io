"use strict";(self.webpackChunkfact_front=self.webpackChunkfact_front||[]).push([[628],{3628:(g,p,s)=>{s.d(p,{m:()=>X});var o=s(3226),_=s(4288),c=s(8513),u=s(6733),a=s(4039),m=s(1749),d=s(3690),A=s(3072),M=s(2997),C=s(4888),b=s(1276),v=s(163),x=s(3551),T=s(5687),y=s(6610),E=s(2845),I=s(2073),Z=s(1464),e=s(755),L=s(2295),U=s(5893);function D(i,l){1&i&&(e.TgZ(0,"span",24),e._uU(1),e.ALo(2,"capitalize"),e.ALo(3,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,e.lcZ(3,3,"a\xf1adir cliente"))," "))}function O(i,l){1&i&&(e.TgZ(0,"span",24),e._uU(1),e.ALo(2,"capitalize"),e.ALo(3,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,e.lcZ(3,3,"editar cliente"))," "))}function P(i,l){1&i&&(e.TgZ(0,"span",24),e._uU(1),e.ALo(2,"capitalize"),e.ALo(3,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,e.lcZ(3,3,"ver cliente"))," "))}function J(i,l){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"capitalize"),e.ALo(3,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,e.lcZ(3,3,"el nombre es requerido"))," "))}function w(i,l){if(1&i&&(e.TgZ(0,"div",25),e.YNc(1,J,4,5,"span",26),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.form.controls.name.hasError("required"))}}function N(i,l){if(1&i&&(e.TgZ(0,"option",30),e._uU(1),e.ALo(2,"capitalize"),e.qZA()),2&i){const t=l.$implicit;e.Q6J("ngValue",null==t?null:t.uuid),e.xp6(1),e.hij(" ",e.lcZ(2,2,null==t?null:t.name)," ")}}function B(i,l){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"capitalize"),e.ALo(3,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,e.lcZ(3,3,"el negocio es requerido"))," "))}function Q(i,l){if(1&i&&(e.TgZ(0,"div",25),e.YNc(1,B,4,5,"span",26),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.form.controls.business.hasError("required"))}}const h=function(i,l){return{"is-invalid":i,"is-valid":l}};function R(i,l){if(1&i&&(e.TgZ(0,"div",27)(1,"label",9),e._uU(2),e.ALo(3,"capitalize"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"select",28),e.YNc(6,N,3,4,"option",29),e.qZA(),e.YNc(7,Q,2,1,"div",11),e.qZA()),2&i){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,4,e.lcZ(4,6,"seleccione un negocio")),": "),e.xp6(3),e.Q6J("ngClass",e.WLB(8,h,t.form.controls.business.touched&&t.form.controls.business.errors,t.form.controls.business.valid)),e.xp6(1),e.Q6J("ngForOf",t.businesses),e.xp6(1),e.Q6J("ngIf",t.form.controls.business.touched&&t.form.controls.business.errors)}}function W(i,l){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"capitalize"),e.ALo(3,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,e.lcZ(3,3,"el pa\xeds es requerido"))," "))}function K(i,l){if(1&i&&(e.TgZ(0,"div",25),e.YNc(1,W,4,5,"span",26),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.form.controls.country.hasError("required"))}}function Y(i,l){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"capitalize"),e.ALo(3,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,e.lcZ(3,3,"el formato de email es incorrecto")),". "))}function q(i,l){if(1&i&&(e.TgZ(0,"div",25),e.YNc(1,Y,4,5,"span",26),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.hasError("pattern"))}}function F(i,l){if(1&i&&(e.TgZ(0,"div",34)(1,"div",35),e._UZ(2,"input",36),e.YNc(3,q,2,1,"div",11),e.qZA()()),2&i){const t=l.$implicit;e.xp6(2),e.Q6J("formControl",t)("ngClass",e.WLB(3,h,t.touched&&t.errors,t.valid)),e.xp6(1),e.Q6J("ngIf",t.touched&&t.errors)}}function j(i,l){if(1&i&&(e.TgZ(0,"div",31)(1,"div",13)(2,"label",9),e._uU(3),e.ALo(4,"capitalize"),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div",32),e.YNc(7,F,4,6,"div",33),e.qZA()()()),2&i){const t=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,2,e.lcZ(5,4,"correo electr\xf3nico")),": "),e.xp6(4),e.Q6J("ngForOf",t.emails().controls)}}function z(i,l){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"capitalize"),e.ALo(3,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,e.lcZ(3,3,"el formato de email es incorrecto")),". "))}function S(i,l){if(1&i&&(e.TgZ(0,"div",25),e.YNc(1,z,4,5,"span",26),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.hasError("pattern"))}}function k(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,f=e.oxw(2);return e.KtG(f.removeCourtesyEmail(r))}),e._UZ(1,"fa-icon",40),e.qZA()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("icon",t.faMinus)}}function V(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",41),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.addCourtesyEmail())}),e._UZ(1,"fa-icon",40),e.qZA()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("icon",t.faAdd)}}function $(i,l){if(1&i&&(e.TgZ(0,"div",34)(1,"div",35),e._UZ(2,"input",36),e.YNc(3,S,2,1,"div",11),e.qZA(),e.YNc(4,k,2,1,"button",37),e.YNc(5,V,2,1,"button",38),e.qZA()),2&i){const t=l.$implicit,n=l.last,r=e.oxw(2);e.xp6(2),e.Q6J("formControl",t)("ngClass",e.WLB(5,h,t.touched&&t.errors,t.valid)),e.xp6(1),e.Q6J("ngIf",t.touched&&t.errors),e.xp6(1),e.Q6J("ngIf",r.courtesyEmails().controls.length>1),e.xp6(1),e.Q6J("ngIf",n)}}function G(i,l){if(1&i&&(e.TgZ(0,"div",31)(1,"div",13)(2,"label",9),e._uU(3),e.ALo(4,"capitalize"),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div",32),e.YNc(7,$,6,8,"div",33),e.qZA()()()),2&i){const t=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,2,e.lcZ(5,4,"copias de cortes\xeda")),": "),e.xp6(4),e.Q6J("ngForOf",t.courtesyEmails().controls)}}function H(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.save())}),e._uU(1),e.ALo(2,"capitalize"),e.ALo(3,"translate"),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("disabled",t.form.invalid),e.xp6(1),e.hij(" ",e.lcZ(2,2,e.lcZ(3,4,"guardar"))," ")}}let X=(()=>{class i extends d.u{constructor(t,n,r,f,ee,te){super(),this._clientService=t,this._countryService=n,this._businessService=r,this._authenticatedUserService=f,this._cdRef=ee,this.activeModal=te,this.isAdminUser=!1,this.identificationFounded=!1,this.faPersonCirclePlus=_.Ukc,this.faMinus=_.Kl4,this.faAdd=_.XSk,this.mode=v.t.CREATE,this.viewModalMode=v.t,this.countries=[],this.businesses=[],this.form=new o.nJ({uuid:new o.p4({value:null,disabled:!0}),name:new o.p4({value:null,disabled:!0},[o.kI.required]),identificationNumber:new o.p4({value:null,disabled:!1},[o.kI.required]),identificationType:new o.p4({value:null,disabled:!1},[o.kI.required]),business:new o.p4({value:null,disabled:!1}),location:new o.p4({value:null,disabled:!0},[o.kI.required]),phone_number:new o.p4({value:null,disabled:!0},[o.kI.required]),receiver:new o.p4({value:null,disabled:!0}),country:new o.p4({value:null,disabled:!0}),code:new o.p4({value:null,disabled:!0}),emails:new o.vC([],[o.kI.minLength(1)]),courtesyEmails:new o.vC([])})}set viewMode(t){this.mode=t??v.t.VIEW,t===v.t.VIEW&&this.form.disable()}set element(t){this._clientService.get(t?.uuid).pipe((0,m.R)(this.observableDestroy$)).subscribe({next:n=>{this.identification={number:n?.identification?.number,type:n?.identification?.type},this._cdRef.detectChanges(),this.form.patchValue({uuid:n?.uuid,name:n?.name,identificationNumber:n?.identification?.number,identificationType:n?.identification?.type,phone_number:n?.phone_number,receiver:n?.receiver,country:n?.country,code:n?.internal_code,location:{province:n?.location?.province?.uuid,canton:n?.location?.canton?.uuid,district:n?.location?.district?.uuid,neighborhood:n?.location?.neighborhood?.uuid,other_signs:n?.location?.other_signs}})}})}getAllBusiness(){this._businessService.getElements({limit:1e3}).pipe((0,m.R)(this.observableDestroy$)).subscribe({next:t=>{this.businesses=t?.results,this._cdRef.detectChanges()}})}getCountries(){this._countryService.getElements().pipe((0,m.R)(this.observableDestroy$)).subscribe({next:t=>{this.countries=t?.results,this._cdRef.detectChanges()}})}save(){const t={uuid:this.form.value?.uuid,business:this.isAdminUser?this.form.value?.business:this._authenticatedUserService.getBusiness(),name:this.form.value?.name,location:{neighborhood:this.form.value?.location?.neighborhood?.uuid,canton:this.form.value?.location?.canton?.uuid,district:this.form.value?.location?.district?.uuid,province:this.form.value?.location?.province?.uuid,other_signs:this.form.value?.location?.otherSigns},country:this.form.value?.country?.uuid,internal_code:this.form.value?.code,identification:{type:this.form.value?.identificationType,number:this.form.value?.identificationNumber},phone_number:"+506 "+this.form.value?.phone_number,email:this.form.value?.emails?.filter(n=>!!n).map(n=>n.toLowerCase())[0],courtesy_copies:this.form.value?.courtesyEmails?.filter(n=>!!n).map(n=>n.toLowerCase())};(!t?.courtesy_copies?.length||0===t?.courtesy_copies?.length)&&delete t.courtesy_copies,this.activeModal.close(t)}getTaxpayerInfo(t){this.form.patchValue({name:t?.nombre,identificationType:t?.tipoIdentificacion,identificationNumber:t?.numeroIdentificacion},{emitEvent:!1}),this.addEmail(),this.addCourtesyEmail(),this.form.get("name").enable(),this.form.get("location").enable(),this.form.get("phone_number").enable(),this.form.get("receiver").enable(),this.form.get("country").enable(),this.form.get("code").enable(),this.form.get("emails").enable(),this.form.get("courtesyEmails").enable(),this.identificationFounded=!0}removeEmail(t){this.emails().removeAt(t)}removeCourtesyEmail(t){this.courtesyEmails().removeAt(t)}emails(){return this.form.get("emails")}courtesyEmails(){return this.form.get("courtesyEmails")}addEmail(){const t=new o.p4({value:null,disabled:!1},[o.kI.pattern(E.CU),o.kI.required]);this.emails().push(t)}addCourtesyEmail(){const t=new o.p4({value:null,disabled:!1},[o.kI.pattern(E.CU)]);this.courtesyEmails().push(t)}changeIdentification(){this.identificationFounded&&(this.form.get("name").disable(),this.form.get("location").disable(),this.form.get("phone_number").disable(),this.form.get("receiver").disable(),this.form.get("country").disable(),this.form.get("code").disable(),this.form.get("emails").disable(),this.form.get("courtesyEmails").disable(),this.identificationFounded=!1)}ngOnInit(){this.isAdminUser=this._authenticatedUserService.isUserAdmin(),this.isAdminUser&&(this.form.get("business").setValidators([o.kI.required]),this.getAllBusiness()),this.getCountries()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(b.y),e.Y36(C.T),e.Y36(Z.m),e.Y36(A.G),e.Y36(e.sBO),e.Y36(L.Kz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-client-modal"]],inputs:{viewMode:"viewMode",element:"element"},standalone:!0,features:[e._Bn([b.y,C.T,Z.m]),e.qOj,e.jDz],decls:49,vars:47,consts:[[1,"modal-header"],[1,"modal-title","d-flex","align-items-center"],[1,"me-2",3,"icon"],["class","component-title",4,"ngIf"],["aria-label","Close","type","button",1,"btn-close",3,"click"],[1,"modal-body","d-flex","flex-column","justify-content-start","gap-3","p-3",3,"formGroup"],[3,"noSearch","data","taxpayerFounded","identificationNumberChanged"],[1,"d-flex","justify-content-between","align-items-start","gap-3"],[1,"d-flex","flex-column","form-group",3,"ngClass"],[1,"control-label","mb-2"],["formControlName","name","type","text",1,"form-control",3,"readonly","ngClass"],["class","invalid-feedback",4,"ngIf"],["class","d-flex flex-column form-group w-25",4,"ngIf"],[1,"d-flex","flex-column","form-group","w-100"],["formControlName","country",3,"items"],["formControlName","phone_number",1,"w-100",3,"disabled"],["formControlName","location",3,"disabled"],[1,"d-flex","flex-column","form-group","w-50"],["formControlName","code","type","text",1,"form-control"],["formControlName","receiver","type","text",1,"form-control"],["class","d-flex justify-content-end gap-3 w-100",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],["class","btn btn-primary","type","button",3,"disabled","click",4,"ngIf"],[1,"component-title"],[1,"invalid-feedback"],[4,"ngIf"],[1,"d-flex","flex-column","form-group","w-25"],["formControlName","business",1,"form-control",3,"ngClass"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"d-flex","justify-content-end","gap-3","w-100"],[1,"d-flex","justify-content-between","align-items-center","flex-wrap","gap-3","w-100"],["class","d-flex justify-content-start align-items-start gap-1 w-49",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-start","align-items-start","gap-1","w-49"],[1,"w-100"],["type","text",1,"form-control",3,"formControl","ngClass"],["class","btn btn-primary danger",3,"click",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"btn","btn-primary","danger",3,"click"],[3,"icon"],[1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h5",1),e._UZ(2,"fa-icon",2),e.YNc(3,D,4,5,"span",3),e.YNc(4,O,4,5,"span",3),e.YNc(5,P,4,5,"span",3),e.qZA(),e.TgZ(6,"button",4),e.NdJ("click",function(){return n.activeModal.close("close")}),e.qZA()(),e.TgZ(7,"div",5)(8,"app-identification-search",6),e.NdJ("taxpayerFounded",function(f){return n.getTaxpayerInfo(f)})("identificationNumberChanged",function(){return n.changeIdentification()}),e.qZA(),e.TgZ(9,"div",7)(10,"div",8)(11,"label",9),e._uU(12),e.ALo(13,"capitalize"),e.ALo(14,"translate"),e.qZA(),e._UZ(15,"input",10),e.YNc(16,w,2,1,"div",11),e.qZA(),e.YNc(17,R,8,11,"div",12),e.qZA(),e.TgZ(18,"div",7)(19,"div",13)(20,"label",9),e._uU(21),e.ALo(22,"titlecase"),e.ALo(23,"translate"),e.qZA(),e._UZ(24,"app-generic-filter-select",14),e.YNc(25,K,2,1,"div",11),e.qZA(),e._UZ(26,"app-phone",15),e.qZA(),e._UZ(27,"app-location",16),e.TgZ(28,"div",7)(29,"div",17)(30,"label",9),e._uU(31),e.ALo(32,"capitalize"),e.ALo(33,"translate"),e.qZA(),e._UZ(34,"input",18),e.qZA(),e.TgZ(35,"div",17)(36,"label",9),e._uU(37),e.ALo(38,"capitalize"),e.ALo(39,"translate"),e.qZA(),e._UZ(40,"input",19),e.qZA()(),e.YNc(41,j,8,6,"div",20),e.YNc(42,G,8,6,"div",20),e.qZA(),e.TgZ(43,"div",21)(44,"button",22),e.NdJ("click",function(){return n.activeModal.close("close")}),e._uU(45),e.ALo(46,"capitalize"),e.ALo(47,"translate"),e.qZA(),e.YNc(48,H,4,6,"button",23),e.qZA()),2&t&&(e.xp6(2),e.Q6J("icon",n.faPersonCirclePlus),e.xp6(1),e.Q6J("ngIf",n.mode===n.viewModalMode.CREATE),e.xp6(1),e.Q6J("ngIf",n.mode===n.viewModalMode.EDIT),e.xp6(1),e.Q6J("ngIf",n.mode===n.viewModalMode.VIEW),e.xp6(2),e.Q6J("formGroup",n.form),e.xp6(1),e.Q6J("noSearch",n.mode===n.viewModalMode.VIEW)("data",n.identification),e.xp6(2),e.Q6J("ngClass",n.isAdminUser?"w-75":"w-100"),e.xp6(2),e.hij(" ",e.lcZ(13,24,e.lcZ(14,26,"nombre")),": "),e.xp6(3),e.Q6J("readonly",!0)("ngClass",e.WLB(44,h,n.form.controls.name.touched&&n.form.controls.name.errors,n.form.controls.name.valid)),e.xp6(1),e.Q6J("ngIf",n.form.controls.name.touched&&n.form.controls.name.errors),e.xp6(1),e.Q6J("ngIf",n.isAdminUser),e.xp6(4),e.hij(" ",e.lcZ(22,28,e.lcZ(23,30,"pa\xeds")),": "),e.xp6(3),e.Q6J("items",n.countries),e.xp6(1),e.Q6J("ngIf",n.form.controls.country.touched&&n.form.controls.country.errors),e.xp6(1),e.Q6J("disabled",!n.identificationFounded),e.xp6(1),e.Q6J("disabled",!n.identificationFounded),e.xp6(4),e.hij(" ",e.lcZ(32,32,e.lcZ(33,34,"c\xf3digo interno")),": "),e.xp6(6),e.hij(" ",e.lcZ(38,36,e.lcZ(39,38,"destinatario")),": "),e.xp6(4),e.Q6J("ngIf",n.identificationFounded),e.xp6(1),e.Q6J("ngIf",n.identificationFounded),e.xp6(3),e.hij(" ",e.lcZ(46,40,e.lcZ(47,42,"cerrar"))," "),e.xp6(3),e.Q6J("ngIf",n.mode!==n.viewModalMode.VIEW))},dependencies:[c.uH,c.BN,u.O5,a.aw,a.X$,M.P,U.e,o.UX,o.YN,o.Kr,o.Fj,o.EJ,o.JJ,o.JL,o.oH,o.sg,o.u,u.mk,u.sg,x.v,T.n,y.$,u.rS,I.v],changeDetection:0}),i})()},1276:(g,p,s)=>{s.d(p,{y:()=>u});var o=s(4230),_=s(7557),c=s(755);let u=(()=>{class a extends o.M{constructor(d){super(d),this.url=_.$e,this.urlId=_.Y3}}return a.\u0275fac=function(d){return new(d||a)(c.LFG(c.zs3))},a.\u0275prov=c.Yz7({token:a,factory:a.\u0275fac}),a})()},4888:(g,p,s)=>{s.d(p,{T:()=>u});var o=s(4230),_=s(7557),c=s(755);let u=(()=>{class a extends o.M{constructor(d){super(d),this.url=_.hV,this.urlId=_.K6}}return a.\u0275fac=function(d){return new(d||a)(c.LFG(c.zs3))},a.\u0275prov=c.Yz7({token:a,factory:a.\u0275fac}),a})()}}]);